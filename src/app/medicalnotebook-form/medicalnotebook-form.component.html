<div class="container mt-5">
  <h2 class="mb-3">ğŸ“ Medical Records Management</h2>

  <!-- CARNET FORM -->
  <form [formGroup]="carnetForm" class="mb-4" (ngSubmit)="saveCarnet()">
    <fieldset class="border p-3 rounded">
      <legend>ğŸ©º Add a Medical Notebook</legend>

      <!-- Select a pet -->
      <div class="mb-3">
        <label for="petSelect">ğŸ¶ Choose a pet</label>
        <select id="petSelect" class="form-select" formControlName="pet_id">
          <option value="" disabled selected>-- Select a pet --</option>
          <option *ngFor="let pet of pets" [value]="pet.id">{{ pet.name }}</option>
        </select>
        <div *ngIf="carnetForm.controls['pet_id'].invalid && carnetForm.controls['pet_id'].touched" class="text-danger">
          Please select a pet.
        </div>
      </div>

      <!-- Submit button -->
      <button type="submit" class="btn btn-primary" [disabled]="carnetForm.invalid">â• Add Notebook</button>
    </fieldset>
  </form>

  <!-- RECORD FORM -->
  <h2 class="mb-3">ğŸ“‚ Medical Records Management</h2>
  <form [formGroup]="recordForm" class="mb-4" (ngSubmit)="saveRecord()">
    <fieldset class="border p-3 rounded">
      <legend>ğŸ“„ Add a Medical Record</legend>

      <div class="mb-3">
        <label>Date</label>
        <input class="form-control" formControlName="date" type="date" required />
        <div *ngIf="recordForm.controls['date'].invalid && recordForm.controls['date'].touched" class="text-danger">
          Date is required.
        </div>
      </div>

      <div class="mb-3">
        <label>Type of service</label>
        <select class="form-select" formControlName="type">
          <option value="VACCINATION">Vaccination</option>
          <option value="SURGERY">Surgery</option>
          <option value="CHECKUP">Check-up</option>
          <option value="MEDICATION">Medication</option>
          <option value="OTHER">Other</option>
        </select>
      </div>

      <div class="mb-3">
        <label>Description</label>
        <input class="form-control" formControlName="description" placeholder="Description" required />
        <div *ngIf="recordForm.controls['description'].invalid && recordForm.controls['description'].touched" class="text-danger">
          The description must be at least 30 characters long.
        </div>
      </div>


      <div class="mb-3">
        <label>Follow-up date </label>
        <input class="form-control" formControlName="next_due_date" type="date" />
      </div>

      <div class="mb-3">
        <label>Select a notebook</label>
        <select class="form-select" formControlName="carnet_id">
          <option value="" disabled selected>-- Select a notebook --</option>
          <option *ngFor="let carnet of carnets" [value]="carnet.id">
            {{ carnet.name }}
          </option>
        </select>
        <div *ngIf="recordForm.controls['carnet_id'].invalid && recordForm.controls['carnet_id'].touched" class="text-danger">
          Please select a notebook.
        </div>
      </div>

      <div class="mb-3">
        <label>Pet's weight (kg)</label>
        <input class="form-control" formControlName="poids" type="number" min="0" required />
        <div *ngIf="recordForm.controls['poids'].invalid && recordForm.controls['poids'].touched" class="text-danger">
          Weight is required.
        </div>
      </div>

      <div class="mb-3">
        <label for="imageUpload">Add an image (optional)</label>
        <input
          id="imageUpload"
          type="file"
          class="form-control"
          (change)="onFileSelected($event)"
        />
      </div>

      <button type="submit" class="btn btn-primary" [disabled]="recordForm.invalid">â• Add Record</button>
    </fieldset>
  </form>
  
  <button type="button" (click)="retour()" class="btn btn-primary">Back</button>
</div>