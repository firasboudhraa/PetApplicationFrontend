<div class="container mt-5">
  <h2 class="text-center mb-4" style="color: #4e73df;">ğŸ“ˆ Statistiques Poids des Carnets</h2>

  <!-- ğŸ”½ Menu dÃ©roulant -->
  <div class="mb-4">
    <label for="carnetSelect" class="form-label">SÃ©lectionnez un carnet :</label>
    <select id="carnetSelect" class="form-control" [(ngModel)]="selectedCarnetId" (change)="onCarnetSelected()">
      <option [ngValue]="null">-- Choisir un carnet --</option>
      <option *ngFor="let carnet of carnets" [ngValue]="carnet.id">
        {{ carnet.name }}
      </option>
    </select>
  </div>

  <!-- ğŸ“Š Graphique Ã©largi -->
  <div *ngIf="lineChartData" class="chart-card">
    <canvas baseChart
            [data]="lineChartData"
            [options]="lineChartOptions"
            [type]="'line'">
    </canvas>
  </div>

  <div *ngIf="!lineChartData && selectedCarnetId !== null" class="alert alert-info mt-4">
    Aucune donnÃ©e de poids disponible pour ce carnet.
  </div>
  <button type="button" (click)="retour()" class="btn btn-primary" >Retour</button>

</div>


<!-- ğŸ’¬ Chat Messenger flottant -->
<div class="chat-box" [class.minimized]="isChatMinimized">
  <div class="chat-header" (click)="toggleChat()">
    <span>ğŸ¾ Pet health Assistant</span>
    <span class="toggle-icon">{{ isChatMinimized ? 'â–²' : 'â–¼' }}</span>
  </div>

  <div class="chat-body" *ngIf="!isChatMinimized">
    <div class="chat-messages">
      <!-- Afficher les messages de l'historique -->
      <div *ngFor="let msg of responseHistory; let i = index" class="chat-message" [ngClass]="{'user-message': i % 2 === 0, 'ai-message': i % 2 !== 0}">
        {{ msg }}
      </div>

      <div *ngIf="isLoading" class="loading">Generating response...</div>
    </div>

    <div class="chat-input-container">
      <input type="text" #userPrompt placeholder="Ask a question..." class="chat-input" />
      <button (click)="askQuestion(userPrompt.value)" class="send-button">Send</button>
    </div>
  </div>
</div>
