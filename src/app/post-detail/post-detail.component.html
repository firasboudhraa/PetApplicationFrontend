<div *ngIf="post" class="post-detail-container">
  <!-- Post Content -->
  <div class="post-header">
    <h2 class="post-title">{{ post.title }}</h2>
    <img class="postcard__img" [src]="post.imageUrl" alt="Post Image">
    <p class="post-content">{{ post.content }}</p>
    <p class="post-author"><strong>Posted By :</strong> {{ authorName || 'Utilisateur inconnu' }} </p>
  </div>
  <time [attr.datetime]="post.createdAt">
    <i class="fas fa-calendar-alt mr-2"></i> Posted At : {{ post.createdAt | date:'EEE, MMM d, y' }}
  </time>

  <!-- Likes Section for Post -->
  <div class="likes-section">
    <button class="like-icon">
      <i class="fa fa-thumbs-up"> Like</i>
    </button>
    <button class="likes-button" (click)="toggleLikesPopup()">
      <i class="fa fa-heart"></i> {{ post.likes }} Like{{ post.likes > 1 ? 's' : '' }}
    </button>
  </div>

  <!-- Comments Section -->
  <div class="comments-section">
    <h3 class="comments-title">
      <i class="fa fa-comments"></i> Commentaires ({{ comments.length }})
    </h3>
    <div *ngFor="let comment of comments" class="post-comment">
      <p class="comment-author">
        <strong><i class="fa fa-user"></i> {{ commentAuthors.get(comment.userId) || 'Utilisateur inconnu' }}:</strong>
      </p>
      <p class="comment-content">{{ comment.content }}</p>

      <!-- Likes Section for each Comment -->
      <div class="comment-likes-section">
        <button (click)="likeComment(comment.id)" class="like-button">
          <i class="fa fa-thumbs-up"></i> Like
        </button>
        <span class="likes-count">{{ comment.likes }} Likes{{ comment.likes > 1 ? 's' : '' }}</span>
      </div>
    </div>

    <!-- Add Comment Section -->
    <div class="add-comment">
      <textarea [(ngModel)]="newCommentContent" placeholder="Add a comment..." rows="3"></textarea>
      <button (click)="addComment()">Post Comment</button>
    </div>
  </div>

  <!-- Likes Popup Modal for Post -->
  <div class="likes-modal" *ngIf="showLikesPopup">
    <div class="likes-modal-content">
      <span class="likes-modal-close" (click)="toggleLikesPopup()">Ã—</span>
      <h3 class="likes-modal-title">
        <i class="fa fa-users"></i> Liked By :
      </h3>
      <ul class="likes-list">
        <li *ngFor="let userId of post.likedBy" class="likes-list-item">
          <i class="fa fa-user"></i> {{ userNames.get(userId) || 'Loading...' }}
        </li>
      </ul>
    </div>
  </div>
</div>
